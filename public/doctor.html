<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Doctor - Medical Records Viewer</title>
  </head>
  <body>
    <h1>Doctor Portal</h1>

    <h2>All Records</h2>
    <button id="refresh">Refresh</button>
    <pre id="allRecords"></pre>

    <h2>Assign Medication</h2>
    <form id="assign">
      <label>Record ID: <input name="recordId" required /></label><br />
      <label>Doctor: <input name="doctor" required /></label><br />
      <label>Medication: <input name="medication" required /></label><br />
      <label>Notes: <input name="notes" /></label><br />
      <button>Assign</button>
    </form>
    <pre id="assignResult"></pre>

    <script>
      async function loadAll(){
        const res = await fetch('/api/doctors/records');
        document.getElementById('allRecords').textContent = JSON.stringify(await res.json(),null,2);
      }
      document.getElementById('refresh').addEventListener('click', loadAll);
      document.getElementById('assign').addEventListener('submit', async e=>{
        e.preventDefault();
        const f=e.target;
        const body = {recordId:f.recordId.value, doctor:f.doctor.value, medication:f.medication.value, notes:f.notes.value};
        const res = await fetch('/api/assignments',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify(body)});
        document.getElementById('assignResult').textContent = await res.text();
      });
      loadAll();
    </script>
  </body>
</html>
